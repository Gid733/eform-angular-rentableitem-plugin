<subheader-pn [title]="'Contracts' | translate">
  <div class="p-3">
    <button
      class="btn btn-success"
      mdbTooltip="{{'Create Contract' | translate}}"
      (click)="showCreateContractModal()"
      id="contractCreateBtn">
      {{'New Contract'}}
    </button>
  </div>
</subheader-pn>

<div class="container-fluid">
  <div class="row p-3 table-responsive no-gutters">
    <table mdbTable striped="true" hover="true" small="true" class="z-depth-1 text-center">
      <thead>
      <tr>
        <th scope="col" class="table-header-sortable" id="idSort"
            (click)="sortByColumn('Id',contractsRequestModel.isSortDsc = !contractsRequestModel.isSortDsc)">
          <div class="d-flex align-items-center justify-content-center">
            ID
            <i class="material-icons text-black-50" *ngIf="contractsRequestModel.sortColumnName != 'Id'">unfold_more</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'Id' && !contractsRequestModel.isSortDsc">
              expand_less</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'Id' && contractsRequestModel.isSortDsc">expand_more</i>
          </div>
        </th>
        <th scope="col" class="table-header-sortable" id="contractNumberSort"
            (click)="sortByColumn('ContractNumber',contractsRequestModel.isSortDsc = !contractsRequestModel.isSortDsc)">
          <div class="d-flex align-items-center justify-content-center">
            {{'Contract Number' | translate}}
            <i class="material-icons text-black-50" *ngIf="contractsRequestModel.sortColumnName != 'ContractNumber'">
              unfold_more</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'ContractNumber' && !contractsRequestModel.isSortDsc">
              expand_less</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'ContractNumber' && contractsRequestModel.isSortDsc">
              expand_more</i>
          </div>
        </th>
        <th scope="col" class="table-header-sortable" id="customerIdSort"
            (click)="sortByColumn('CustomerId',contractsRequestModel.isSortDsc = !contractsRequestModel.isSortDsc)">
          <div class="d-flex align-items-center justify-content-center">
            {{'Customer' | translate}}
            <i class="material-icons text-black-50" *ngIf="contractsRequestModel.sortColumnName != 'CustomerId'">
              unfold_more</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'CustomerId' && !contractsRequestModel.isSortDsc">
              expand_less</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'CustomerId' && contractsRequestModel.isSortDsc">
              expand_more</i>
          </div>
        </th>
        <th scope="col" class="table-header-sortable" id="brandSort"
            (click)="sortByColumn('Brand',contractsRequestModel.isSortDsc = !contractsRequestModel.isSortDsc)">
          <div class="d-flex align-items-center justify-content-center">
            {{'Brand' | translate}}
            <i class="material-icons text-black-50" *ngIf="contractsRequestModel.sortColumnName != 'Brand'">
              unfold_more</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'Brand' && !contractsRequestModel.isSortDsc">
              expand_less</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'Brand' && contractsRequestModel.isSortDsc">
              expand_more</i>
          </div>
        </th>
        <th scope="col" class="table-header-sortable" id="modelSort"
            (click)="sortByColumn('ModelName',contractsRequestModel.isSortDsc = !contractsRequestModel.isSortDsc)">
          <div class="d-flex align-items-center justify-content-center">
            {{'Model' | translate}}
            <i class="material-icons text-black-50" *ngIf="contractsRequestModel.sortColumnName != 'ModelName'">
              unfold_more</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'ModelName' && !contractsRequestModel.isSortDsc">
              expand_less</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'ModelName' && contractsRequestModel.isSortDsc">
              expand_more</i>
          </div>
        </th>
        <th scope="col" class="table-header-sortable" id="regDateSort"
            (click)="sortByColumn('RegistrationDate',contractsRequestModel.isSortDsc = !contractsRequestModel.isSortDsc)">
          <div class="d-flex align-items-center justify-content-center">
            {{'Reg. date' | translate}}
            <i class="material-icons text-black-50" *ngIf="contractsRequestModel.sortColumnName != 'RegistrationDate'">
              unfold_more</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'RegistrationDate' && !contractsRequestModel.isSortDsc">
              expand_less</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'RegistrationDate' && contractsRequestModel.isSortDsc">
              expand_more</i>
          </div>
        </th>
        <th scope="col" class="table-header-sortable" id="vinNumberSort"
            (click)="sortByColumn('VinNumber',contractsRequestModel.isSortDsc = !contractsRequestModel.isSortDsc)">
          <div class="d-flex align-items-center justify-content-center">
            {{'Vin no.' | translate}}
            <i class="material-icons text-black-50" *ngIf="contractsRequestModel.sortColumnName != 'VinNumber'">
              unfold_more</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'VinNumber' && !contractsRequestModel.isSortDsc">
              expand_less</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'VinNumber' && contractsRequestModel.isSortDsc">
              expand_more</i>
          </div>
        </th>
        <th scope="col" class="table-header-sortable" id="startDateSort"
            (click)="sortByColumn('StartDate',contractsRequestModel.isSortDsc = !contractsRequestModel.isSortDsc)">
          <div class="d-flex align-items-center justify-content-center">
            {{'Start date' | translate}}
            <i class="material-icons text-black-50" *ngIf="contractsRequestModel.sortColumnName != 'StartDate'">
              unfold_more</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'StartDate' && !contractsRequestModel.isSortDsc">
              expand_less</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'StartDate' && contractsRequestModel.isSortDsc">
              expand_more</i>
          </div>
        </th>
        <th scope="col" class="table-header-sortable" id="endDateSort"
            (click)="sortByColumn('EndDate',contractsRequestModel.isSortDsc = !contractsRequestModel.isSortDsc)">
          <div class="d-flex align-items-center justify-content-center">
            {{'End date' | translate}}
            <i class="material-icons text-black-50" *ngIf="contractsRequestModel.sortColumnName != 'EndDate'">
              unfold_more</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'EndDate' && !contractsRequestModel.isSortDsc">
              expand_less</i>
            <i class="material-icons"
               *ngIf="contractsRequestModel.sortColumnName == 'EndDate' && contractsRequestModel.isSortDsc">
              expand_more</i>
          </div>
        </th>
        <th scope="col">
          {{ 'Actions' | translate }}
        </th>
      </tr>
      </thead>
      <tbody id="tableBody">
      <tr *ngFor="let contract of contractsModel.contracts">
        <td id="contractId">
          {{contract.id}}
        </td>
        <td id="contractNumber">
          {{contract.contractNr}}
        </td>
        <td id="contractCustomer">
          {{contract.customer.companyName}}
          <br *ngIf="contract.customer.contactPerson !== null">
          {{contract.customer.contactPerson}}
        </td>
        <td id="brand">
          <div *ngFor="let rentableItem of contract.rentableItems">
            {{rentableItem.brand}}
          </div>
        </td>
        <td id="model">
          <div *ngFor="let rentableItem of contract.rentableItems">
            {{rentableItem.modelName}}
          </div>
        </td>
        <td id="regdate">
          <div *ngFor="let rentableItem of contract.rentableItems">
            {{rentableItem.registrationDate | date:'dd/MM/yyyy'}}
          </div>
        </td>
        <td id="vinNo">
          <div *ngFor="let rentableItem of contract.rentableItems">
            {{rentableItem.vinNumber}}
          </div>
        </td>
        <td id="contractStart">
          {{contract.contractStart | date:'dd/MM/yyyy'}}
        </td>
        <td id="contractEnd">
          {{contract.contractEnd | date:'dd/MM/yyyy'}}
        </td>
        <td>
          <div class="d-flex flex-row justify-content-center">
            <button mdbBtn class="btn-accent text-black-50 btn-icon mb-2"
                    mdbTooltip="{{ 'Edit Contract' | translate }}"
                    (click)="showEditContractModal(contract)"
                    id="contractEditBtn">
              <fa-icon icon="pen" [fixedWidth]="true" size="lg"></fa-icon>
            </button>
            <button mdbBtn class="btn-danger btn-icon mb-2"
                    mdbTooltip="{{'Delete Contract' | translate}}"
                    (click)="showDeleteContractModal(contract)"
                    id="contractDeleteBtn">
              <fa-icon icon="trash-alt" [fixedWidth]="true" size="lg"></fa-icon>
            </button>
            <button mdbBtn class="text-black-50 btn-icon mb-2"
                    mdbTooltip="{{'Add Inspection' | translate}}"
                    (click)="showCreateInspectionModal(contract)"
                    id="createInspectionBtn">
              <fa-icon icon="list-alt" [fixedWidth]="true" size="lg"></fa-icon>
            </button>
          </div>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>

<app-contracts-add #createContractModal
                   (onContractCreated)="getAllContracts()"></app-contracts-add>
<app-contracts-update #editContractModal
                      (onContractUpdated)="getAllContracts()"></app-contracts-update>
<app-contract-delete #deleteContractModal
                     (onContractDeleted)="getAllContracts()"></app-contract-delete>
<app-inspections-add #createInspectionModal></app-inspections-add>
<app-contract-rentable-item #contractRentableItem></app-contract-rentable-item>
